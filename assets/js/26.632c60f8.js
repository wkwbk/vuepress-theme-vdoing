(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{442:function(s,a,e){"use strict";e.r(a);var t=e(7),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("Portainer æ˜¯ä¸€æ¬¾å…è´¹ã€å¼€æºçš„ Docker çš„å›¾å½¢åŒ–ç®¡ç†å·¥å…·ï¼Œå…¶èƒ½å¤Ÿæä¾›çŠ¶æ€æ˜¾ç¤ºé¢æ¿ã€åº”ç”¨æ¨¡æ¿å¿«é€Ÿéƒ¨ç½²ã€å®¹å™¨é•œåƒç½‘ç»œæ•°æ®å·çš„åŸºæœ¬æ“ä½œï¼ˆåŒ…æ‹¬ä¸Šä¼ ä¸‹è½½é•œåƒï¼Œåˆ›å»ºå®¹å™¨ç­‰æ“ä½œï¼‰ã€äº‹ä»¶æ—¥å¿—æ˜¾ç¤ºã€å®¹å™¨æ§åˆ¶å°æ“ä½œã€Swarm é›†ç¾¤å’ŒæœåŠ¡ç­‰é›†ä¸­ç®¡ç†å’Œæ“ä½œã€ç™»å½•ç”¨æˆ·ç®¡ç†å’Œæ§åˆ¶ç­‰åŠŸèƒ½ã€‚")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"å®‰è£…-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-docker"}},[s._v("#")]),s._v(" å®‰è£… Docker")]),s._v(" "),a("h3",{attrs:{id:"æ›´æ–°ã€å®‰è£…å¿…å¤‡è½¯ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ›´æ–°ã€å®‰è£…å¿…å¤‡è½¯ä»¶"}},[s._v("#")]),s._v(" æ›´æ–°ã€å®‰è£…å¿…å¤‡è½¯ä»¶")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"docker-å®‰è£…"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-å®‰è£…"}},[s._v("#")]),s._v(" Docker å®‰è£…")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -qO- get.docker.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sSL")]),s._v(" get.docker.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"æŸ¥çœ‹-docker-ç‰ˆæœ¬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹-docker-ç‰ˆæœ¬"}},[s._v("#")]),s._v(" æŸ¥çœ‹ Docker ç‰ˆæœ¬")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"å¼€æœºè‡ªåŠ¨å¯åŠ¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¼€æœºè‡ªåŠ¨å¯åŠ¨"}},[s._v("#")]),s._v(" å¼€æœºè‡ªåŠ¨å¯åŠ¨")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"å¸è½½-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¸è½½-docker"}},[s._v("#")]),s._v(" å¸è½½ Docker")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" purge docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/containerd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"docker-compose-å®‰è£…"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-å®‰è£…"}},[s._v("#")]),s._v(" Docker-compose å®‰è£…")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/v2.29.7/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" /usr/local/bin/docker-compose\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--version")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"docker-åŸºæœ¬å‘½ä»¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-åŸºæœ¬å‘½ä»¤"}},[s._v("#")]),s._v(" Docker åŸºæœ¬å‘½ä»¤")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æŸ¥çœ‹è¿è¡Œçš„é•œåƒè¿›ç¨‹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CONTAINER ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#åœæ­¢è¯¥é•œåƒè¿›ç¨‹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CONTAINER ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å¯åŠ¨è¯¥é•œåƒè¿›ç¨‹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CONTAINER ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å¸è½½é•œåƒ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æŸ¥çœ‹å½“å‰ Docker çš„é•œåƒ IMAGE ID")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IMAGE ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#åˆ é™¤é•œåƒ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"ä¿®æ”¹-docker-é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¿®æ”¹-docker-é…ç½®"}},[s._v("#")]),s._v(" ä¿®æ”¹ Docker é…ç½®")]),s._v(" "),a("p",[s._v("é™åˆ¶æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé˜²æ­¢ Docker æ—¥å¿—å¡æ»¡ç¡¬ç›˜")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('EOF\n{\n    "log-driver": "json-file",\n    "log-opts": {\n        "max-size": "20m",\n        "max-file": "3"\n    }\n}\nEOF')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("ç„¶åé‡å¯ Docker æœåŠ¡")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"å®‰è£…-portainer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-portainer"}},[s._v("#")]),s._v(" å®‰è£… Portainer")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ›å»ºç›®å½•åŒæ—¶è¿›å…¥")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /root/docker/portainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä¸‹è½½ docker compose é…ç½®æ–‡ä»¶")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" https://img.lisir.me/file/docker/portainer/docker-compose.yml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¯åŠ¨")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" compose up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"é…ç½®-docker-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®-docker-api"}},[s._v("#")]),s._v(" é…ç½® Docker API")]),s._v(" "),a("ul",[a("li",[s._v("åœ¨éœ€è¦æ·»åŠ åˆ° Portainer çš„æœåŠ¡å™¨ä¸­å®‰è£… Docker")]),s._v(" "),a("li",[s._v("å®‰è£…å®Œæˆ Docker åï¼Œä¿®æ”¹ vim /usr/lib/systemd/system/docker.service æš´éœ² docker api æ¥å£")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å‘½ä»¤æŸ¥çœ‹ docker.service æ–‡ä»¶æ‰€åœ¨è·¯å¾„")]),s._v("\nsystemctl status docker.service\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç¼–è¾‘ docker.service æ–‡ä»¶")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /lib/systemd/system/docker.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("ä¿®æ”¹é…ç½®é¡¹ExecStartä¸­çš„å€¼ä¸ºï¼š")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" tcp://0.0.0.0:2375 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" fd:// "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--containerd")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run/containerd/containerd.sock\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("ğŸš« ç›´æ¥å¼€å¯éåŠ å¯†çš„ Docker API æ˜¯ä¸ªéå¸¸å±é™©çš„è¡Œä¸ºï¼")])]),s._v(" "),a("p",[s._v("é‡å¯ Docker æœåŠ¡")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é‡æ–°åŠ è½½æœåŠ¡é…ç½®æ–‡ä»¶")]),s._v("\nsystemctl daemon-reload\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é‡å¯ Docker æœåŠ¡")]),s._v("\nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("åœ¨ Portainer æ‰€åœ¨æœåŠ¡å™¨æµ‹è¯•æ˜¯å¦å¯è¿æ¥ç›®æ ‡æœåŠ¡å™¨ Docker Api")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ ¼å¼ docker -H [ç›®æ ‡æœåŠ¡å™¨IP/å…¬ç½‘IP]:[2375/å¤–ç½‘IPæ˜ å°„çš„ç«¯å£å·] info")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:2375 info\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å‡ºç°ä»¥ä¸‹å†…å®¹åˆ™é…ç½®æˆåŠŸ")]),s._v("\nWARNING: API is accessible on http://0.0.0.0:2375 without encryption.\n         Access to the remote API is equivalent to root access on the host. Refer\n         to the "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Docker daemon attack surface'")]),s._v(" section "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the documentation "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" information: https://docs.docker.com/engine/security/security/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker-daemon-attack-surface")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("å®Œæˆä»¥ä¸Šå†…å®¹åå³å¯åœ¨ Portainer çš„ â€œç«¯ç‚¹/EndPointâ€ èœå•ä¸­ç‚¹å‡» â€œæ·»åŠ ç«¯ç‚¹/Add EndPointâ€, æ¥æ·»åŠ ç›®æ ‡æœåŠ¡å™¨ DockerèŠ‚ç‚¹")]),s._v(" "),a("h2",{attrs:{id:"å¼€å¯-tls-è®¤è¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¼€å¯-tls-è®¤è¯"}},[s._v("#")]),s._v(" å¼€å¯ TLS è®¤è¯")]),s._v(" "),a("p",[s._v("Docker è‡ªå¸¦ API åŠŸèƒ½ï¼Œæ”¯æŒå¯¹ Docker è¿›è¡Œç®¡ç†ï¼Œä½†æ˜¯é»˜è®¤å¹¶ä¸å¯ç”¨ï¼Œè€Œä¸”ä¸€èˆ¬åœ¨æ²¡æœ‰å¼€å¯åŠ å¯†é€šä¿¡çš„æ—¶å€™ç›´æ¥å¯ç”¨ API ä¼šæœ‰å®‰å…¨é£é™©ã€‚")]),s._v(" "),a("p",[s._v("å› æ­¤æˆ‘ä»¬éœ€è¦å¼€å¯ TLS åŠ å¯†æ¥ä¿éšœ Docker API é€šä¿¡çš„å®‰å…¨æ€§ã€‚é€šè¿‡å¼€å¯ TLS é˜²æ­¢æœªç»è®¸å¯çš„å®¢æˆ·ç«¯è®¿é—®æœåŠ¡ç«¯èŠ‚ç‚¹ï¼Œä¿éšœå…¶ç³»ç»Ÿå®‰å…¨æ€§ã€‚")]),s._v(" "),a("p",[s._v("è€Œ Docker API ä¹Ÿé€‚ç”¨äºåœ¨ä¸€ä¸ª Portainer ç¤ºä¾‹ä¸Šæ¥è¿œç¨‹ç®¡ç†å¤šå°æœºå™¨ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æœ€åˆä½¿ç”¨è¿™ä¸€åŠŸèƒ½çš„åŸå› ã€‚æ¥ä¸‹æ¥å°†ä»‹ç»å¦‚ä½•å®Œæˆ TLS çš„è®¾ç½®ï¼Œæ¥ä¿éšœ Docker API é€šä¿¡çš„å®‰å…¨æ€§ã€‚")]),s._v(" "),a("h3",{attrs:{id:"åˆ›å»º-tls-è¯ä¹¦"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-tls-è¯ä¹¦"}},[s._v("#")]),s._v(" åˆ›å»º TLS è¯ä¹¦")]),s._v(" "),a("p",[s._v("è„šæœ¬é“¾æ¥ï¼š"),a("a",{attrs:{href:"https://img.lisir.me/file/shell/generate_docker_api_pem.sh",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://img.lisir.me/file/shell/generate_docker_api_pem.sh"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è·å–è„šæœ¬å¹¶èµ‹äºˆæ‰§è¡Œæƒé™")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://img.lisir.me/file/shell/generate_docker_api_pem.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x generate_docker_api_pem.sh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ‰§è¡Œè„šæœ¬")]),s._v("\n./generate_docker_api_pem.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"å¼€å¯-docker-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¼€å¯-docker-api"}},[s._v("#")]),s._v(" å¼€å¯ Docker API")]),s._v(" "),a("p",[s._v("ç¼–è¾‘ docker é…ç½®æ–‡ä»¶ï¼š")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /lib/systemd/system/docker.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("æ‰¾åˆ° ExecStart è¡Œï¼Œåœ¨åé¢æ·»åŠ ä»¥ä¸‹é€‰é¡¹ï¼š")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tcp://0.0.0.0:2376 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tlsverify")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tlscacert")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root/.docker/certs/ca-docker_api.pem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tlscert")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root/.docker/certs/server-cert-docker_api.pem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tlskey")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root/.docker/certs/server-key-docker_api.pem\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°åŠ è½½æœåŠ¡å¹¶é‡å¯ Dockerï¼š")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl daemon-reload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"é…ç½®-portainer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®-portainer"}},[s._v("#")]),s._v(" é…ç½® Portainer")]),s._v(" "),a("ul",[a("li",[s._v("æ‰“å¼€ Portainerï¼Œè¿›å…¥ Environmentsã€‚")]),s._v(" "),a("li",[s._v("ç‚¹å‡»å³ä¸Šè§’çš„ Add environment æ·»åŠ èŠ‚ç‚¹ï¼Œå¹¶åœ¨éšåçš„å‘å¯¼ä¸­é€‰æ‹© APIã€‚")]),s._v(" "),a("li",[s._v("å°† Environment URL æˆ–è€… Docker API URL ä¸­çš„ç«¯å£ä» 2375 æ”¹ä¸º 2376ã€‚")]),s._v(" "),a("li",[s._v("ç„¶åå°† TLS çš„ Switch æ‰“å¼€ï¼Œä¸Šä¼ è¯ä¹¦æ–‡ä»¶å³å¯ã€‚")])])])}),[],!1,null,null,null);a.default=r.exports}}]);